<!--ToDo
    on submit, grab values from everything, throw into object.
    Post that object
    Re-write the constructor to accept the object and not freak out.
    Then you don't have to worry about screwing with the HTML form POST thing.
-->

<!DOCTYPE html>
<html>
<head>
    <title>Survey</title>
<!--Because I like fonts -->
    <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed" rel="stylesheet">
    <style>
        p {
            font-family: 'Saira Extra Condensed', sans-serif;
            font-size: 24px
        }

    </style>
</head>
<!-- Include *all* the things! -->
<script src="https://code.jquery.com/jquery.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
<body style="background-color: #000">
    <div class="container" style="background-color: #aaa">
        <div class="row">
            <div class="col">
                <h1 class="display-4 mt-4">Survey Questions</h1>
                <hr>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <form action=""></form>
                    <label for="name">Name</label>
                    <input type="name" class="form-control" id="nameInput" placeholder="Enter Name" style="background-color: #000; color: #fff">

                    <label for="pictureInput">Link to Photo Image (required)</label>
                    <input type="pictureInput" class="form-control" id="pictureInput" style="background-color: #000; color: #fff">
                    <!--This was annoying enough I was tempted to just write a bit of the server code that generated the questions HTML from an array of questions.
                        But I didn't quite get that much motivation-->
                    <div class="text-center">
                        <h4 class="mt-5">Question 1</h4>
                        <p>Pineapple is a good pizza topping.</p>
                        <select class="chosen-select" id="question1">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 2</h4>
                        <p>Star Wars is better than Star Trek.</p>
                        <select class="chosen-select" id="question2">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 3</h4>
                        <p>Kirk is a better captain than Picard.</p>
                        <select class="chosen-select" id="question3">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 4</h4>
                        <p>Irregardless is a word.</p>
                        <select class="chosen-select" id="question4">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 5</h4>
                        <p>Whataburger is better than Inn-n-Out</p>
                        <select class="chosen-select" id="question5">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 6</h4>
                        <p>Gif is pronounced like the peanut butter.</p>
                        <select class="chosen-select" id="question6">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 7</h4>
                        <p>A hot dog is, technically, a sandwich.</p>
                        <select class="chosen-select" id="question7">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <h4 class="mt-5">Question 8</h4>
                        <p>That dress was black and blue, not white and gold.</p>
                        <select class="chosen-select" id="question8">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <div class="text-center">
                        <h4 class="mt-5">Question 9</h4>
                        <p>The toilet paper should hang over/in front of the roll.</p>
                            <select class="chosen-select" id="question9">
                                <option selected>Select an option</option>
                                <option value="5">5 (Strongly Agree)</option>
                                <option value="4">4</option>
                                <option value="3">3</option>
                                <option value="2">2</option>
                                <option value="1">1 (Strongly Disagree)</option>
                            </select>
                        </div>
                        <div class="text-center">
                        </div>
                        <h4 class="mt-5">Question 10</h4>
                        <p>I like taking surveys to discover my personality.</p>
                        <select class="chosen-select" id="question10">
                            <option selected>Select an option</option>
                            <option value="5">5 (Strongly Agree)</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1 (Strongly Disagree)</option>
                        </select>
                    </div>
                        
                 <button type='submit' class="btn btn-block btn-inverse my-3"id="submit"><h3>Submit</h3></button>
                </form>
            </div>
        </div>
        <!-- Directly stolen from Bootstrap, with IDs added and changed -->

    <div class="modal fade resultsModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="resultsModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <!--Huh. So that's how you get the little "close" X-->
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title">Best Match</h2>
                </div>
                <div class="modal-body">
                    <h2 id="matchName"></h2>
                    <img id="matchImage" src="" alt="">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    //Look, if you're going to provide me with a working example of a site
    //With a cool looking feature
    //I'm going to steal it.
    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      '.chosen-select-width'     : {width:"95%"}
    }
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }
    //originally was trying to create a constructor
    //Then realized I'm storing the data in friends.js, not as a bunch of objects floating around the page
    //Code preserved for historical value or something
    /*function NewFriend(name, picture, q1, q2, q3, q4, q5, q6, q7, q8, q9, q10){
        this.name = name;
        this.photo = picture
        this.scores = [q1, q2, q3, q4, q5, q6, q7, q8, q9, q10]
    }*/

    //When click a button, do a thing
    $("#submit").on('click', function(){
        //But don't do the normal thing
        event.preventDefault();

        //Make sure someone actually entered a name and picture.
        //I still sorta feel like I'm faking my way through returns, but at least it's working.
        function validateForm(){
            var isValid = true;
            $(".form-control").each(function(){
                if ($(this).val() === ""){
                    isValid = false;
                };
            });
            return isValid;
        }
        if (validateForm()){
        var user = {
            name: $("#nameInput").val().trim(),
            photo: $("#pictureInput").val().trim(),
            scores: [
            $("#question1").val(),
            $("#question2").val(),
            $("#question3").val(),
            $("#question4").val(),
            $("#question5").val(),
            $("#question6").val(),
            $("#question7").val(),
            $("#question8").val(),
            $("#question9").val(),
            $("#question10").val()
            ]
        }
        //to make this work on Heroku, too
        var currentURL = window.location.origin
        $.post(currentURL + "/api/friends", user)
          .done(function(data) {
            $("#matchName").text(data.name);
            $("#matchImage").attr("src", data.photo);
            $('#resultsModal').modal("toggle");
            //This should really be a modal or something, but for now it works and gives feedback that it's doing something.
            alert("Calculating Future Soulmate...");
          });
        $.get("/api/friends")
    } else {
        //I really should do some validation to make sure that the picture link ends with .jpg, .png, etc.
        //But I don't have the time or motivation right now.
        alert("Sorry, you missed a field. Please make sure you entered a name and a picture.");
    }

//Close the click listener. Because I always forget which set of parentheses this is.
});




</script>




</body>

</html>
